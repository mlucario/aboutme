// $enable-rfs: false;

//
// SCSS RFS mixin
//
// Automated responsive values for for font sizes, paddings, margins and much more
//
// Licensed under MIT (https://github.com/twbs/rfs/blob/master/LICENSE)

// Configuration
// * USE rfs for bootstraps
$enable-responsive-font-sizes: true !default;
// Base value
$rfs-base-value: 1.25rem !default;
$rfs-unit: rem !default;

@if $rfs-unit !=rem and $rfs-unit !=px {
  @error "`#{$rfs-unit}` is not a valid unit for $rfs-unit. Use `px` or `rem`.";
}

// Breakpoint at where values start decreasing if screen width is smaller
$rfs-breakpoint: 1200px !default;
$rfs-breakpoint-unit: px !default;

@if $rfs-breakpoint-unit !=px and $rfs-breakpoint-unit !=em and $rfs-breakpoint-unit !=rem {
  @error "`#{$rfs-breakpoint-unit}` is not a valid unit for $rfs-breakpoint-unit. Use `px`, `em` or `rem`.";
}

// Resize values based on screen height and width
$rfs-two-dimensional: false !default;

// Factor of decrease
$rfs-factor: 10 !default;

@if type-of($rfs-factor) !=number or $rfs-factor <=1 {
  @error "`#{$rfs-factor}` is not a valid  $rfs-factor, it must be greater than 1.";
}

// Mode. Possibilities: "min-media-query", "max-media-query"
$rfs-mode: min-media-query !default;

// Generate enable or disable classes. Possibilities: false, "enable" or "disable"
$rfs-class: false !default;

// 1 rem = $rfs-rem-value px
$rfs-rem-value: 16 !default;

// Safari iframe resize bug: https://github.com/twbs/rfs/issues/14
$rfs-safari-iframe-resize-bug-fix: true !default; // Only for this codepen demo

// Disable RFS by setting $enable-rfs to false
$enable-rfs: true !default;

// Cache $rfs-base-value unit
$rfs-base-value-unit: unit($rfs-base-value);

// Remove px-unit from $rfs-base-value for calculations
@if $rfs-base-value-unit==px {
  $rfs-base-value: $rfs-base-value / ($rfs-base-value * 0 + 1);
}

@else if $rfs-base-value-unit==rem {
  $rfs-base-value: $rfs-base-value / ($rfs-base-value * 0 + 1 / $rfs-rem-value);
}

// Cache $rfs-breakpoint unit to prevent multiple calls
$rfs-breakpoint-unit-cache: unit($rfs-breakpoint);

// Remove unit from $rfs-breakpoint for calculations
@if $rfs-breakpoint-unit-cache==px {
  $rfs-breakpoint: $rfs-breakpoint / ($rfs-breakpoint * 0 + 1);
}

@else if $rfs-breakpoint-unit-cache==rem or $rfs-breakpoint-unit-cache=="em" {
  $rfs-breakpoint: $rfs-breakpoint / ($rfs-breakpoint * 0 + 1 / $rfs-rem-value);
}

// Calculate the media query value
$rfs-mq-value: if($rfs-breakpoint-unit==px, #{$rfs-breakpoint}px, #{$rfs-breakpoint / $rfs-rem-value}#{$rfs-breakpoint-unit});
$rfs-mq-property-width: if($rfs-mode==max-media-query, max-width, min-width);
$rfs-mq-property-height: if($rfs-mode==max-media-query, max-height, min-height);

// Internal mixin that adds disable classes to the selector if needed.
@mixin _rfs-disable-class {
  @if $rfs-class==disable {

    // Adding an extra class increases specificity, which prevents the media query to override the property
    &,
    .disable-rfs &,
    &.disable-rfs {
      @content;
    }
  }

  @else {
    @content;
  }
}

// Internal mixin that adds enable classes to the selector if needed.
@mixin _rfs-enable-class {
  @if $rfs-class==enable {

    .enable-rfs &,
    &.enable-rfs {
      @content;
    }
  }

  @else {
    @content;
  }
}

// Internal mixin used to determine which media query needs to be used
@mixin _rfs-media-query {
  @if $rfs-two-dimensional {

    @media (#{$rfs-mq-property-width}: #{$rfs-mq-value}),
    (#{$rfs-mq-property-height}: #{$rfs-mq-value}) {
      @content;
    }
  }

  @else {
    @media (#{$rfs-mq-property-width}: #{$rfs-mq-value}) {
      @content;
    }
  }
}

// Helper function to get the formatted non-responsive value
@function rfs-value($value) {
  @if $value==0 {
    @return 0;
  }

  // Cache $fs unit
  $unit: if(type-of($value)=="number", unit($value), false);

  @if $unit=="" {
    // Add appropriate unit
    @return if($rfs-unit==rem, #{$value / $rfs-rem-value}rem, #{$value}px);
  }

  @if $unit==px {
    // Convert to rem if needed
    @return if($rfs-unit==rem, #{$value / ($value * 0 + $rfs-rem-value)}rem, $value);
  }

  @if $unit==rem {
    // Convert to px if needed
    @return if($rfs-unit==px, #{$value / ($value * 0 + 1) * $rfs-rem-value}px, $value);
  }

  // If $fs isn't a number (like inherit) or $fs has a unit (not px or rem, like 1.5em) or $ is 0, just print the value
  @return $value;
}

// Helper function to get the responsive value calculated by RFS
@function rfs-fluid-value($value) {
  @if $value==0 {
    @return 0;
  }

  // Cache $fs unit
  $unit: if(type-of($value)=="number", unit($value), false);

  // If $fs isn't a number (like inherit) or $fs has a unit (not px or rem, like 1.5em) or $ is 0, just print the value
  @if not $unit or $unit !=""and $unit !=px and $unit !=rem {
    @return $value;
  }

  // Remove unit from $fs for calculations
  @if $unit==px {
    $value: $value / ($value * 0 + 1);
  }

  @else if $unit==rem {
    $value: $value / ($value * 0 + 1 / $rfs-rem-value);
  }

  // Only add the media query if the value is greater than the minimum value
  @if $value <=$rfs-base-value or not $enable-rfs {
    @return if($rfs-unit==rem, #{$value / $rfs-rem-value}rem, #{$value}px);
  }

  // Calculate the minimum value
  $value-min: $rfs-base-value+($value - $rfs-base-value) / $rfs-factor;

  // Calculate difference between $value and the minimum value
  $value-diff: $value - $value-min;

  // Base value formatting
  $min-width: if($rfs-unit==rem, #{$value-min / $rfs-rem-value}rem, #{$value-min}px);

  // Use `vmin` if two-dimensional is enabled
  $variable-unit: if($rfs-two-dimensional, vmin, vw);

  // Calculate the variable width between 0 and $rfs-breakpoint
  $variable-width: #{$value-diff * 100 / $rfs-breakpoint}#{$variable-unit};

  // Return the calculated value
  @return calc(#{$min-width} + #{$variable-width});
}

// RFS mixin
@mixin rfs($values, $property: font-size) {
  // Cast to list
  $values: if(type-of($values) !=list, ($values, ), $values);

  $val: '';
  $fluidVal: '';

  // Loop over each value and calculate responsive & non-responsive values
  @each $value in $values {
    $val: $val + ' '+ rfs-value($value);
    $fluidVal: $fluidVal + ' '+ rfs-fluid-value($value);
  }

  // Remove first space
  $val: str-slice($val, 2);
  $fluidVal: str-slice($fluidVal, 2);

  // Do not print the media query if responsive & non-responsive values are the same
  @if $val==$fluidVal {
    #{$property}: #{$val};
  }

  @else {
    @include _rfs-disable-class {
      #{$property}: unquote(if($rfs-mode==max-media-query, $val, $fluidVal));

      // Include safari iframe resize fix if needed
      min-width: if($rfs-safari-iframe-resize-bug-fix and $rfs-mode==min-media-query, (0 * 1vw), null);
    }

    @include _rfs-media-query {
      @include _rfs-enable-class {
        #{$property}: unquote(if($rfs-mode==max-media-query, $fluidVal, $val));

        // Include safari iframe resize fix if needed
        min-width: if($rfs-safari-iframe-resize-bug-fix and $rfs-mode==max-media-query, (0 * 1vw), null);
      }
    }
  }
}

// Shorthand helper mixins
@mixin font-size($value) {
  @include rfs($value);
}

@mixin padding($value) {
  @include rfs($value, padding);
}

@mixin padding-top($value) {
  @include rfs($value, padding-top);
}

@mixin padding-right($value) {
  @include rfs($value, padding-right);
}

@mixin padding-bottom($value) {
  @include rfs($value, padding-bottom);
}

@mixin padding-left($value) {
  @include rfs($value, padding-left);
}

@mixin margin($value) {
  @include rfs($value, margin);
}

@mixin margin-top($value) {
  @include rfs($value, margin-top);
}

@mixin margin-right($value) {
  @include rfs($value, margin-right);
}

@mixin margin-bottom($value) {
  @include rfs($value, margin-bottom);
}

@mixin margin-left($value) {
  @include rfs($value, margin-left);
}


// ! extra setup for bootstrap
@media (max-width: 1200px) {
  legend {
    font-size: calc(1.275rem + 0.3vw);
  }

  h1,
  .h1 {
    font-size: calc(1.375rem + 1.5vw);
  }

  h2,
  .h2 {
    font-size: calc(1.325rem + 0.9vw);
  }

  h3,
  .h3 {
    font-size: calc(1.3rem + 0.6vw);
  }

  h4,
  .h4 {
    font-size: calc(1.275rem + 0.3vw);
  }

  .display-1 {
    font-size: calc(1.725rem + 5.7vw);
  }

  .display-2 {
    font-size: calc(1.675rem + 5.1vw);
  }

  .display-3 {
    font-size: calc(1.575rem + 3.9vw);
  }

  .display-4 {
    font-size: calc(1.475rem + 2.7vw);
  }

  .close {
    font-size: calc(1.275rem + 0.3vw);
  }
}